{{ define "main" }}
{{ $scratch := newScratch }}
{{ $scratch.Set "filter" (where .Pages "Section" "blog").ByLastmod.Reverse }}
{{ if .IsHome }}
{{ $scratch.Set "filter" (first 10 (where (where .Site.Pages "Section" "blog") ".IsPage" "==" true).ByLastmod.Reverse ) }}
{{ end }}
{{ $filter := $scratch.Get "filter" }}
<main class="leading-relaxed text-xl grid grid-cols-1 lg:grid-cols-7">
    {{ partial "autor-bio" . }}
    <div class="w-full px-5 py-12 lg:max-w-prose lg:col-span-6">
        <h3><a href="/">Derniers billets</a></h3>
        {{ range $filter }}
        <article>
            {{ if isset .Params "affiliatelink" }}
            {{ $url := urls.Parse .Params.affiliatelink }}
            <em class="hidden lg:block float-right text-base mt-1 after:content-linkout after:text-sm">{{ $url.Host }}</em>
            <h2 class="mb-1"><a href="{{ .Params.affiliatelink }}" target="_blank" title="{{ .Title }}">{{ .Title }} </a></h2>
            {{else}}
            <h2 class="mb-1"><a href="{{ .Permalink }}" title="{{ .Title }}">{{ .Title }}</a></h2>
            {{ end }}
            <p class="italic">{{ .Params.excerpt | default .Summary | default .Description | default .Title | plainify | truncate 160 }}</p>
        </article>
        {{ end }}
    </div><!-- /#index -->
</main>
{{ end }}